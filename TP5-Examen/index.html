<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Boussole</title>
    </head>
    <body>
    <div id="Canvas">

    </div>
    <script>
        var divCanvas = document.getElementById("Canvas");
        var zoneCanvas = document.createElement("canvas");
        var ctx = zoneCanvas.getContext("2d");
        var imgB = document.createElement("img");
        var imgA = document.createElement("img");

        zoneCanvas.height="200";
        zoneCanvas.width="200";
        divCanvas.appendChild(zoneCanvas);
        imgB.src = 'img/compass.png'
        imgA.src = 'img/needle.png'
        imgB.onload = function () {
            ctx.drawImage(imgB, 0, 0);
            imgA.onload = function () {
                ctx.drawImage(imgA, 0, 0);

            }
        }

        window.addEventListener('deviceorientation', function (event) {
            console.log("change detected");
            var angle = event.alpha;
            var rad = angle * (Math.PI / 180);
            ctx.clearRect(0, 0, zoneCanvas.width, zoneCanvas.height);
            ctx.drawImage(imgB, 0, 0);
            ctx.save();
            ctx.translate(zoneCanvas.width / 2, zoneCanvas.height / 2);
            ctx.rotate(rad);
            ctx.translate(- zoneCanvas.width / 2, - zoneCanvas.height / 2);
            ctx.drawImage(imgA, 0, 0);
            ctx.restore();
            ctx.transform();
        });
    </script>
    </body>
</html>
